{
  "name": "spec-to-acceptance-criteria",
  "description": "Sequential workflow from text input to acceptance criteria (with enforced human gates)",
  "version": "1.1",
  "steps": [
    {
      "id": "pre_run_gate",
      "name": "Human Input Confirmation",
      "agent": "human",
      "type": "manual",
      "input": "{user_input}",
      "output": "pre_run_decision",
      "dependencies": [],
      "checkpoint": true,
      "approval_required": true,
      "blocking": true,
      "fail_if_unapproved": true,
      "description": "Show the raw user input and require a human to approve or edit before any AI step runs."
    },
    {
      "id": "input_validation",
      "name": "Record Approved Input",
      "agent": "human",
      "type": "manual",
      "input": "{user_input}",
      "output": "input_confirmed",
      "dependencies": ["pre_run_gate"],
      "checkpoint": true,
      "approval_required": true,
      "blocking": true,
      "condition": "pre_run_decision == 'approved'",
      "description": "Second lightweight gate to capture/confirm any edits before analysis begins."
    },
    {
      "id": "decompose_task",
      "name": "Task Analysis",
      "agent": "system-architect",
      "type": "analysis",
      "input": "{user_input}",
      "output": "task_breakdown",
      "dependencies": ["input_validation"]
    },
    {
      "id": "generate_spec",
      "name": "Create Functional Specification",
      "agent": "product-spec-generator",
      "type": "generation",
      "input": "{task_breakdown}",
      "output": "functional_spec",
      "dependencies": ["decompose_task"]
    },
    {
      "id": "human_validation",
      "name": "Human Review of Spec",
      "agent": "human",
      "type": "manual",
      "input": "{functional_spec}",
      "output": "approval_decision",
      "dependencies": ["generate_spec"],
      "checkpoint": true,
      "approval_required": true,
      "blocking": true,
      "fail_if_unapproved": true,
      "description": "Human must approve the generated functional specification before criteria are produced."
    },
    {
      "id": "generate_criteria",
      "name": "Create Acceptance Criteria",
      "agent": "acceptance-criteria-generator",
      "type": "generation",
      "input": "{functional_spec}",
      "output": "acceptance_criteria",
      "dependencies": ["human_validation"],
      "condition": "approval_decision == 'approved'"
    },
    {
      "id": "final_signoff",
      "name": "Final Human Sign-off",
      "agent": "human",
      "type": "manual",
      "input": "{functional_spec, acceptance_criteria}",
      "output": "final_decision",
      "dependencies": ["generate_criteria"],
      "checkpoint": true,
      "approval_required": true,
      "blocking": true,
      "fail_if_unapproved": true,
      "description": "One last confirmation on assembled deliverables."
    },
    {
      "id": "final_assembly",
      "name": "Assemble Final Deliverables",
      "agent": "documentation-coordinator",
      "type": "assembly",
      "input": "{functional_spec, acceptance_criteria}",
      "output": "final_artifacts",
      "dependencies": ["final_signoff"],
      "condition": "final_decision == 'approved'"
    }
  ],
  "execution": {
    "strategy": "sequential",
    "require_ui": true,
    "checkpoint_behavior": "pause_on_checkpoint",
    "on_missing_approver": "pause",
    "retry_policy": {
      "max_retries": 2,
      "backoff": "exponential"
    }
  },
  "outputs": {
    "functional_spec": "docs/functional-specs/",
    "acceptance_criteria": "docs/acceptance-criteria/",
    "final_artifacts": "docs/deliverables/"
  }
}

